<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>cs224n Lecture 8 | Eomiso&#39;s TIL(Today I Learned)</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/TIL/logo.png">
    <meta name="description" content="Write what you have learned today">
    <link rel="preload" href="/TIL/assets/css/0.styles.34c10105.css" as="style"><link rel="preload" href="/TIL/assets/js/app.2722f0f6.js" as="script"><link rel="preload" href="/TIL/assets/js/2.2c4c9c51.js" as="script"><link rel="preload" href="/TIL/assets/js/17.07c38e4d.js" as="script"><link rel="prefetch" href="/TIL/assets/js/10.2f8e0e30.js"><link rel="prefetch" href="/TIL/assets/js/11.1ff1a57e.js"><link rel="prefetch" href="/TIL/assets/js/12.15c40c13.js"><link rel="prefetch" href="/TIL/assets/js/13.7bf652e1.js"><link rel="prefetch" href="/TIL/assets/js/14.c9414a20.js"><link rel="prefetch" href="/TIL/assets/js/15.2d01f370.js"><link rel="prefetch" href="/TIL/assets/js/16.0d89dffe.js"><link rel="prefetch" href="/TIL/assets/js/18.442c0c06.js"><link rel="prefetch" href="/TIL/assets/js/19.1b5bf633.js"><link rel="prefetch" href="/TIL/assets/js/20.86bba05d.js"><link rel="prefetch" href="/TIL/assets/js/21.e544340d.js"><link rel="prefetch" href="/TIL/assets/js/22.65a2edf5.js"><link rel="prefetch" href="/TIL/assets/js/23.8b174a85.js"><link rel="prefetch" href="/TIL/assets/js/24.64fc03d5.js"><link rel="prefetch" href="/TIL/assets/js/25.ce0ae723.js"><link rel="prefetch" href="/TIL/assets/js/26.8b8ee881.js"><link rel="prefetch" href="/TIL/assets/js/27.bf8c97e7.js"><link rel="prefetch" href="/TIL/assets/js/28.142e3c12.js"><link rel="prefetch" href="/TIL/assets/js/29.81bd0da5.js"><link rel="prefetch" href="/TIL/assets/js/3.313ef446.js"><link rel="prefetch" href="/TIL/assets/js/30.359dbc7f.js"><link rel="prefetch" href="/TIL/assets/js/31.0727ec46.js"><link rel="prefetch" href="/TIL/assets/js/32.fe1c9148.js"><link rel="prefetch" href="/TIL/assets/js/33.a56a58e6.js"><link rel="prefetch" href="/TIL/assets/js/34.27b6efed.js"><link rel="prefetch" href="/TIL/assets/js/35.62f50cfb.js"><link rel="prefetch" href="/TIL/assets/js/36.87dcc99f.js"><link rel="prefetch" href="/TIL/assets/js/37.0e07a91e.js"><link rel="prefetch" href="/TIL/assets/js/38.205eff79.js"><link rel="prefetch" href="/TIL/assets/js/39.aaa60523.js"><link rel="prefetch" href="/TIL/assets/js/4.b761c68e.js"><link rel="prefetch" href="/TIL/assets/js/40.6b01a59c.js"><link rel="prefetch" href="/TIL/assets/js/41.1eb27f61.js"><link rel="prefetch" href="/TIL/assets/js/42.6841e3f3.js"><link rel="prefetch" href="/TIL/assets/js/43.de455827.js"><link rel="prefetch" href="/TIL/assets/js/5.a3718665.js"><link rel="prefetch" href="/TIL/assets/js/6.13ab33a4.js"><link rel="prefetch" href="/TIL/assets/js/7.d95456ce.js"><link rel="prefetch" href="/TIL/assets/js/8.8630e26e.js"><link rel="prefetch" href="/TIL/assets/js/9.1c63a592.js">
    <link rel="stylesheet" href="/TIL/assets/css/0.styles.34c10105.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TIL/" class="home-link router-link-active"><!----> <span class="site-name">Eomiso's TIL(Today I Learned)</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/eomiso" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://eomiso.blogspot.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/eomiso" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://eomiso.blogspot.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>1. Python</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2. Git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>3. Java</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>4. C++</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>5. Machine Learning</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TIL/ML/cssn224_1.html" class="sidebar-link">CSS224n Lecture 12</a></li><li><a href="/TIL/ML/cssn224_2.html" class="sidebar-link">CS224n 6강</a></li><li><a href="/TIL/ML/cs224n_3.html" class="active sidebar-link">cs224n Lecture 8</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TIL/ML/cs224n_3.html#개요" class="sidebar-link">개요</a></li><li class="sidebar-sub-header"><a href="/TIL/ML/cs224n_3.html#stochastic-machine-translation" class="sidebar-link">Stochastic Machine translation</a></li><li class="sidebar-sub-header"><a href="/TIL/ML/cs224n_3.html#word-alignment" class="sidebar-link">Word alignment</a></li><li class="sidebar-sub-header"><a href="/TIL/ML/cs224n_3.html#sequence-to-squence-model" class="sidebar-link">Sequence-to-squence model</a></li><li class="sidebar-sub-header"><a href="/TIL/ML/cs224n_3.html#end-eof" class="sidebar-link"></a></li><li class="sidebar-sub-header"><a href="/TIL/ML/cs224n_3.html#beam-search-decoding" class="sidebar-link">Beam search decoding</a></li><li class="sidebar-sub-header"><a href="/TIL/ML/cs224n_3.html#bleu-score" class="sidebar-link">BLEU score</a></li><li class="sidebar-sub-header"><a href="/TIL/ML/cs224n_3.html#bottleneck-problem" class="sidebar-link">Bottleneck problem</a></li><li class="sidebar-sub-header"><a href="/TIL/ML/cs224n_3.html#attention" class="sidebar-link">Attention</a></li></ul></li><li><a href="/TIL/ML/cs224n_4.html" class="sidebar-link">cs224n Lecture 13</a></li><li><a href="/TIL/ML/cs224n_5.html" class="sidebar-link">cs224n Lecture 14</a></li><li><a href="/TIL/ML/cs224n_6.html" class="sidebar-link">cs224n 10강 정리</a></li><li><a href="/TIL/ML/cs224n_7.html" class="sidebar-link">cs224n lecture 15</a></li><li><a href="/TIL/ML/ml_dict.html" class="sidebar-link">Machine Learning 용어 사전</a></li><li><a href="/TIL/ML/style_transfer.html" class="sidebar-link">Style Transfer from Non-Parallel Text by Cross-Alignment 리뷰</a></li><li><a href="/TIL/ML/using_bert.html" class="sidebar-link">Bert 사용기</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>6. Computer Structure</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Mics.</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="cs224n-lecture-8"><a href="#cs224n-lecture-8" class="header-anchor">#</a> cs224n Lecture 8</h1> <p>부제 : Machine Learning이라는 새로운 task와 sequence-to-sequence 라는 새로운 <strong>architecture</strong></p> <h2 id="개요"><a href="#개요" class="header-anchor">#</a> 개요</h2> <ul><li>Statistical Machine translation</li> <li>Word alignment</li> <li>Sequence-to-sequence model</li> <li><END>, <EOF></EOF></END></li> <li>Beam search decoding</li> <li>BLEU score</li> <li>bottleneck problem</li> <li>Attention</li></ul> <h2 id="stochastic-machine-translation"><a href="#stochastic-machine-translation" class="header-anchor">#</a> Stochastic Machine translation</h2> <p>MT : translating a sentence from <strong>source language</strong> to the <strong>target language</strong>
Machine Translation of the past.</p> <p>Learn a probabilistic model from data
Want to find best English sentence <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi></mjx-math></mjx-container>, given French sentence <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi></mjx-math></mjx-container></p><p><mjx-container jax="CHTML" display="true" class="MathJax"><mjx-math display="true" class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="r"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="g"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container></p> <p><mjx-container jax="CHTML" display="true" class="MathJax"><mjx-math display="true" class=" MJX-TEX"><mjx-mo class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mi space="4" class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="r"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="g"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mtext class="mjx-n"><mjx-c c="T"></mjx-c><mjx-c c="r"></mjx-c><mjx-c c="a"></mjx-c><mjx-c c="n"></mjx-c><mjx-c c="s"></mjx-c><mjx-c c="l"></mjx-c><mjx-c c="a"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="i"></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="n"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="M"></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="d"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="l"></mjx-c><mjx-c c="("></mjx-c><mjx-c c="F"></mjx-c><mjx-c c="i"></mjx-c><mjx-c c="d"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="l"></mjx-c><mjx-c c="i"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="y"></mjx-c><mjx-c c=")"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="*"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="L"></mjx-c><mjx-c c="a"></mjx-c><mjx-c c="n"></mjx-c><mjx-c c="g"></mjx-c><mjx-c c="u"></mjx-c><mjx-c c="a"></mjx-c><mjx-c c="g"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="M"></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="d"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="l"></mjx-c><mjx-c c="("></mjx-c><mjx-c c="f"></mjx-c><mjx-c c="l"></mjx-c><mjx-c c="u"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="n"></mjx-c><mjx-c c="c"></mjx-c><mjx-c c="y"></mjx-c><mjx-c c=")"></mjx-c></mjx-mtext></mjx-math></mjx-container></p>
Nead <strong>parallel data</strong><p></p> <h2 id="word-alignment"><a href="#word-alignment" class="header-anchor">#</a> Word alignment</h2> <p>How to learn translation model <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container> from the parallel corpus?</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Break it down furthur: Introduce latent <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi></mjx-math></mjx-container> variable into the model
latent가 정확히 뭐지??</p></div> <p></p><p><mjx-container jax="CHTML" display="true" class="MathJax"><mjx-math display="true" class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mi space="2" class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mtext class="mjx-n"><mjx-utext variant="normal" style="font-family:serif;">사</mjx-utext><mjx-utext variant="normal" style="font-family:serif;">실</mjx-utext><mjx-utext variant="normal" style="font-family:serif;">이</mjx-utext><mjx-c c=" "></mjx-c><mjx-utext variant="normal" style="font-family:serif;">수</mjx-utext><mjx-utext variant="normal" style="font-family:serif;">식</mjx-utext><mjx-c c=" "></mjx-c><mjx-utext variant="normal" style="font-family:serif;">제</mjx-utext><mjx-utext variant="normal" style="font-family:serif;">대</mjx-utext><mjx-utext variant="normal" style="font-family:serif;">로</mjx-utext><mjx-c c=" "></mjx-c><mjx-utext variant="normal" style="font-family:serif;">이</mjx-utext><mjx-utext variant="normal" style="font-family:serif;">해</mjx-utext><mjx-utext variant="normal" style="font-family:serif;">가</mjx-utext><mjx-c c=" "></mjx-c><mjx-utext variant="normal" style="font-family:serif;">안</mjx-utext><mjx-utext variant="normal" style="font-family:serif;">갑</mjx-utext><mjx-utext variant="normal" style="font-family:serif;">니</mjx-utext><mjx-utext variant="normal" style="font-family:serif;">다</mjx-utext><mjx-c c="5C"></mjx-c><mjx-c c="c"></mjx-c><mjx-c c="d"></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="s"></mjx-c><mjx-c c="A0"></mjx-c></mjx-mtext></mjx-math></mjx-container></p> <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi></mjx-math></mjx-container> is the <strong>alignment</strong>
::: detail What is alignment
&quot;Correspondence between particular words&quot;
:::
<strong>Typological Difference</strong> 는 alignment 를 어렵게한다.(one-to-many, many-to-many)<p></p> <p><img src="/TIL/ML/MT_alignment.png" alt=""></p> <p>::: detail Latent Variables
????
:::</p> <p>Alignment 까지 고려해서(<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mi space="2" class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>)를 학습시키고 <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="r"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="g"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="p"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container> 로 Decoding을 한다. 여기서 argmax를 계산하는게 너무 비효율적일 수 있기 때문에 일종의 heuristic search algorithm을 적용시킨다. __independence assumption__과  __dynamic programmin__을 적용시켜 globally optimal solution 을 찾아낸다. (Viterbi algorhtim : 슬라이드는 있는데 이해가 안가서 일단 넘어감)</p> <p>아무튼 SMT는 사람 손이 많이 가는 모델이었고 NN의 시대가 오면서 당연히 이를 이용한 MT 모델이 등장하게 되었다. seq2seq</p> <h2 id="sequence-to-squence-model"><a href="#sequence-to-squence-model" class="header-anchor">#</a> Sequence-to-squence model</h2> <p>하나의 NN을 이용한 Machine Translation으로 (2014년에 등장) 두 개의 RNN이 관련되어 있다.
쉽게 얘기해서 source sentence를 encoding하고 그 결과로 나온 hidden state을 가지고Decoder에 넣어서 target sentence를 생성하는 것이다.</p> <p><img src="/TIL/ML/MT_seq2seq.png" alt="Neural Machine Translation slide"></p> <p>Seq2seq model은 Conditional Language model의 예시다. target sentence <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi></mjx-math></mjx-container>의 다음단어를 예측한다는 점에서 LM이고 그 prediction이 source sentence에 의해 제약된다는 점에서 conditional 하다고 볼 수 있다.</p> <p>NMT는 <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container> 를 직접 계산한다. </p><p><mjx-container jax="CHTML" display="true" class="MathJax"><mjx-math display="true" class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mi space="4" class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn size="s" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn size="s" class="mjx-n"><mjx-c c="2"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn size="s" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mi space="2" class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn size="s" class="mjx-n"><mjx-c c="3"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn size="s" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn size="s" class="mjx-n"><mjx-c c="2"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mi space="2" class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo space="2" class="mjx-n"><mjx-c c="2026"></mjx-c></mjx-mo><mjx-mi space="2" class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="T"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn size="s" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mo space="2" class="mjx-n"><mjx-c c="2026"></mjx-c></mjx-mo><mjx-mo space="2" class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="T"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mi space="2" class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mtext class="mjx-n"><mjx-c c="T"></mjx-c><mjx-c c="h"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="l"></mjx-c><mjx-c c="a"></mjx-c><mjx-c c="s"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="r"></mjx-c><mjx-c c="m"></mjx-c><mjx-c c=":"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="p"></mjx-c><mjx-c c="r"></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="b"></mjx-c><mjx-c c="a"></mjx-c><mjx-c c="b"></mjx-c><mjx-c c="i"></mjx-c><mjx-c c="l"></mjx-c><mjx-c c="i"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="y"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="f"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="n"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="x"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="a"></mjx-c><mjx-c c="r"></mjx-c><mjx-c c="g"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="w"></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="r"></mjx-c><mjx-c c="d"></mjx-c><mjx-c c=","></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="g"></mjx-c><mjx-c c="i"></mjx-c><mjx-c c="v"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="n"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="a"></mjx-c><mjx-c c="r"></mjx-c><mjx-c c="g"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="w"></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="r"></mjx-c><mjx-c c="d"></mjx-c><mjx-c c="s"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="s"></mjx-c><mjx-c c="o"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="f"></mjx-c><mjx-c c="a"></mjx-c><mjx-c c="r"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="a"></mjx-c><mjx-c c="n"></mjx-c><mjx-c c="d"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="s"></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="u"></mjx-c><mjx-c c="r"></mjx-c><mjx-c c="c"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="s"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="n"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="n"></mjx-c><mjx-c c="c"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="x"></mjx-c></mjx-mtext></mjx-math></mjx-container></p>
이는 <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mi space="2" class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container> 혹은 <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo space="3" class="mjx-n"><mjx-c c="2217"></mjx-c></mjx-mo><mjx-mi space="3" class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>를 구하는 SMT 방식과 차이를 보이는 지점이다._<p></p> <p>그래서 NMT를 어떻게 학습할 수 있는가? 매우 큰 Parallel corpus를 가지고 와랏.
<img src="/TIL/ML/MT_train.png" alt="NMT training"></p> <p>::: detail Questions
Is it necessary to do end-to-end training? -&gt; separating training may result with problems in opimalization when they are put together. Optimalization of the seperate does not neccessarily suggest that they are optimal together. BUT unconditional 한 LM을 만들고 싶어 하는 경우에는 Decoder 만 따로 학습 시킬 수도 있겠다.
:::
::: detail Questions2
Should the length of the input sentences be fixed? -&gt; No since the RNN-LM has pros in a way that they don't have any pre-defined window size. But in practice or implementation, Just because it is easier if you can assume the size of the length in each batch has same size you can use padding to enforce unary length to the sentences in a batch. And then make sure that you don't use any hidden state that came from the padding.
:::</p> <p>그리고 여기서 word vector는 다운로드 받을 수도 있고, 직접 학습시킬 수도 있다(6강에서 했던 얘기)</p> <h2 id=""><a href="#" class="header-anchor">#</a> <END><EOF></EOF></END></h2> <p>사실 Greedy Decoding이 <END> 가 나올 때까지 계속 decoding해 가는 것이다. 이러한 stopping criterion이 Beam search decoding에서 살펴봐야할 subtopic이다.</END></p> <p>아래에서 해야할 얘기를 여기서 좀 하면, beam search decoding을 하는데 있어서 k 개의 hypothesis 중에 <END>가 나온게 있으면 그냥 잠시 치워두고 나머지 hypothesis를 이어나간다. 계속 가다가 T 만큼(some pre-defined cutoff) length가 길어지면 그냥 잘라버린다. (k 개 hypothesis 중에서 적어도 한 개는 <END>가 나오길 바라는 것)</END></END></p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>참고로 training data에 이런 <END> token을 넣어줘야만 한다.</END></p></div> <h2 id="beam-search-decoding"><a href="#beam-search-decoding" class="header-anchor">#</a> Beam search decoding</h2> <p>문제의식 : <strong>Greedy Decoding</strong>(단순히 각 hidden step 으로부터 argmax(softmax)를 하는 것은 문제가 있다. 왜냐하면 해당 step에서의 argmax가 전체 문장에서 argmax(<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>)를 보장하지 않는데, 그것을 뒤의 step에서 알게되었다 하더라도 앞의 step으로 돌아갈 수가 없기 때문이다. __exhaustive search decoding__을 사용하는 경우에는(length T 만큼의 translation을 기억하고 있는 채로 넘어가는 것)은 <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="O"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c c="V"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;margin-left:0.087em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="T"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container> 만큼의 complexity를 같기 때문에 너무 비싸다고 할 수 있다. 이 두가지 방식의 한계를 극복하고자 __Beam Search Decoding__이라는 것을 적용한 것이다.</p> <p>저장은 하는데 가장 probable 한 partial translations 를 k 만큼 저장하면서 따라가는 것이다(keep track of the k most probable partial translations) -&gt; _hypothesis_라고 부른다. rmf그리고 <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="k"></mjx-c></mjx-mi></mjx-math></mjx-container>는 beam size.
</p><p><mjx-container jax="CHTML" display="true" class="MathJax"><mjx-math display="true" class=" MJX-TEX"><mjx-mrow><mjx-mtext class="mjx-n"><mjx-c c="s"></mjx-c><mjx-c c="c"></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="r"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="("></mjx-c></mjx-mtext><mjx-TeXAtom><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn size="s" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mo space="2" class="mjx-n"><mjx-c c="2026"></mjx-c></mjx-mo><mjx-mo space="2" class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-TeXAtom><mjx-mtext class="mjx-n"><mjx-c c="A0"></mjx-c></mjx-mtext></mjx-mrow><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mi space="4" class="mjx-n"><mjx-c c="l"></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="g"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="2061"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="L"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="M"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn size="s" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mo space="2" class="mjx-n"><mjx-c c="2026"></mjx-c></mjx-mo><mjx-mo space="2" class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-munderover space="4"><mjx-over style="padding-bottom:0.192em;padding-left:0.594em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-lop"><mjx-c c="2211"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top:0.167em;padding-left:0.148em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mi space="2" class="mjx-i"><mjx-c c="l"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="o"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="g"></mjx-c></mjx-mi><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="L"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="M"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn size="s" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mo space="2" class="mjx-n"><mjx-c c="22EF"></mjx-c></mjx-mo><mjx-mo space="2" class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mi space="2" class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container></p>
보다 정확히 말하자면 경우의 수를 k개로 유지하면서 step unrolling해 나가는 것인데(가만 여기서 unrolling은 encoder에서만 사용하는 말이던가?) 선택된 k 개에서 각각의 k개 option을 추출하고(2k) 거기서 다시 k개만큼 선택해서 다음 step으로 나아간다는 것이다. 아래 슬라이드가 이해하기 <s>편하다</s><p></p> <p><img src="/TIL/ML/MT_beamsearch.png" alt="Beam search decoding"></p> <p>마지막으로 위의 식을 보면 길이가 짧은 hypothesis가 높은 확률을 가질 수 밖에 없는데 이를 해결하기 위해서 <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn><mjx-TeXAtom><mjx-mo class="mjx-n"><mjx-c c="/"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c c="T"></mjx-c></mjx-mi></mjx-math></mjx-container> 로 normalization을 해줘야 한다.
</p><p><mjx-container jax="CHTML" display="true" class="MathJax"><mjx-math display="true" class=" MJX-TEX"><mjx-merror><mjx-mtext class="mjx-n"><mjx-c c=" "></mjx-c><mjx-c c="5C"></mjx-c><mjx-c c="d"></mjx-c><mjx-c c="f"></mjx-c><mjx-c c="r"></mjx-c><mjx-c c="a"></mjx-c><mjx-c c="c"></mjx-c><mjx-c c="{"></mjx-c><mjx-c c="1"></mjx-c><mjx-c c="}"></mjx-c><mjx-c c="{"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="}"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="5C"></mjx-c><mjx-c c="s"></mjx-c><mjx-c c="u"></mjx-c><mjx-c c="m"></mjx-c><mjx-c c="_"></mjx-c><mjx-c c="{"></mjx-c><mjx-c c="i"></mjx-c><mjx-c c="="></mjx-c><mjx-c c="1"></mjx-c><mjx-c c="}"></mjx-c><mjx-c c="^"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="l"></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="g"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="P"></mjx-c><mjx-c c="_"></mjx-c><mjx-c c="{"></mjx-c><mjx-c c="L"></mjx-c><mjx-c c="M"></mjx-c><mjx-c c="}"></mjx-c><mjx-c c="("></mjx-c><mjx-c c="y"></mjx-c><mjx-c c="_"></mjx-c><mjx-c c="i"></mjx-c><mjx-c c="|"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="y"></mjx-c><mjx-c c="_"></mjx-c><mjx-c c="1"></mjx-c><mjx-c c=","></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="5C"></mjx-c><mjx-c c="d"></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="s"></mjx-c><mjx-c c=","></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="y"></mjx-c><mjx-c c="_"></mjx-c><mjx-c c="{"></mjx-c><mjx-c c="i"></mjx-c><mjx-c c="-"></mjx-c><mjx-c c="1"></mjx-c><mjx-c c="}"></mjx-c><mjx-c c=","></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="x"></mjx-c><mjx-c c=")"></mjx-c><mjx-c c="_"></mjx-c></mjx-mtext></mjx-merror></mjx-math></mjx-container></p><p></p> <p>::: detail Smart Question
Why not use normalized score during the beam search decoding? -&gt; 사실 beam search를 하는 중에는 같은 길이의 hypothesis만 비교하는 것이기 때문에 굳이 costly한 나누기를 해줄 필요가 없다.
:::</p> <h3 id="pros-cons"><a href="#pros-cons" class="header-anchor">#</a> Pros &amp; Cons</h3> <p>일단 더 번역을 잘한다. 맥락을 더 잘 활용하고 비슷한 의미의 다른 문장들을 잘 활용한다(better use of phrase similarities). 한 개의 뉴럴넷을 end-to-end로 optimize하면 된다(뭐 굳더더기 subcomponents가 없다). 그래서 사람 손이 덜 간다. 그리고 언어페어 별로 범용으로 사용할 수 있는 모델이다(물론 학습은 각각 시켜야겠지만).</p> <p>그런데 Less Interprate 하다(어떻게 돌아가는지를 모른다; NN 전반의 문제). 그리고 콘트롤하기 어렵다(어떤 규칙을 적용시키기 어렵다. 특정단어에 대한 규칙을 따로 적용하기가 어렵다). Safety 문제가 있다(욕을 못하게 할 수가 없다).</p> <h2 id="bleu-score"><a href="#bleu-score" class="header-anchor">#</a> BLEU score</h2> <p>Bilingual Evaluation Understudy. Computes Similarity score based on n-gram(기계가 번역한 결과를 n-gram으로 나타냈을 때 그 n-gram이 인간 번역에서도 나타나는지 확인하는 것) and penalty for too-short system ranslations(n-gram은 conservative한 문장에 대해서 점수를 다 줘버리기 때문이다. 잘못해석할까봐 짧고 추상적으로 번역하는 부분에 대한 penalty)</p> <p>하지만 BLEU도 완벽하지 않은데, n-gram 하고 겹치지 않더라도 좋은 번역일 수 있기 때문이다. <s>그래도 이부분은 사람 번역이랑 비교를 하는 것이니 믿고 맡겨도 되지 않을까??</s></p> <p>참고로 BLEU는 precision을 구한다.</p> <p>하지만 아직 NMT에도 부족한 점이 많다.</p> <blockquote><p>Out-of-vocabulary words -&gt; subword modeling(character based modle)<br>
Domain mismatch between train and test data<br>
Maintaining context over longer text -&gt; 강의에서는 한문장만 번역하는 걸 보여줬지만, 도큐먼트 단위로 번역하려면 expensive 해진다.<br>
Low-resource Language pairs  
over all common sense 기계에 적용하는건 여전히 어렵다.
NMT picks up biases in training data -&gt; 젠더가 없는 입력 데이터를 젠더가 있는 문장으로 출력하는 경우(train data에 더 많이 등장하는 젠더가 등장한다).
입력 데이터가 noise에 불과한 경우에는 오토파일럿으로 영어 decoder를 사용하는 것으로 알려져 있다.
You neve know it would happen untill they happen.</p></blockquote> <h2 id="bottleneck-problem"><a href="#bottleneck-problem" class="header-anchor">#</a> Bottleneck problem</h2> <p>RNN에 한 개 종류의 vector에 계속 정보를 주입하기 때문에 기본적으로 bottleneck probelm이 발생한다.</p> <blockquote><p>encoder가 너무 많이 돌면(인풋 문장, 도튜먼트가 너무 길면) 끝에 가서는 첫 단어에 대한 정보가 hidden state 안에서 거의 사라져버렸을 가능성이 있다.</p></blockquote> <h2 id="attention"><a href="#attention" class="header-anchor">#</a> Attention</h2> <p>bottle neck problem을 해결하고자 나온 새로운 vanilla seq2seq NMT system : <strong>Attention</strong></p> <div class="custom-block tip"><p class="custom-block-title">Main Idea</p> <p>On each step of the decoder, use direct connection to the encoder to focus on a particular part of the source sequence.</p></div> <ol><li>decoder hidden layer를 가지고 encoder hidden state 과 dot product를 수행해 총 N개(input length) 만큼의 attention score를 구한다.</li> <li>이 attention score에 softmax를 적용해 Attention distribution을 구한다.</li> <li>Attention distribution을 이용해 encoder hidden state의 weighted sum을 구한다. 이것이 Attention output</li> <li>Attention output 을 decoder hidden state과 concatenate 해서 사용한다(이를 이용해 <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-TeXAtom><mjx-mover><mjx-over style="padding-bottom:0.06em;padding-left:0.056em;margin-bottom:-0.531em;"><mjx-mo class="mjx-n"><mjx-c c="^"></mjx-c></mjx-mo></mjx-over><mjx-base style="padding-left:0.005em;"><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-TeXAtom></mjx-math></mjx-container>즉, decoder의 hidden state을 구한다</li></ol> <p><img src="/TIL/ML/MT_equation.png" alt="equation of attention"></p> <p>이를 통해 vanishing gradient problem 를 해결할 수도 있고, NN가 어디에 집중하고 있는지를 알아낼 수도 있어 NMT가 interpretable 하지 못하다는 문제를 극복할 수 있었다.</p> <h3 id="variant-of-attention"><a href="#variant-of-attention" class="header-anchor">#</a> Variant of attention</h3> <p>attention score(scalar 값들)를 구하는데 있어서 variants가 세가지 정도 존재한다.
Basic dot-product attention, Multiplicative attention, Additive attention</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/12/2020, 1:52:29 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/TIL/ML/cssn224_2.html" class="prev">
        CS224n 6강
      </a></span> <span class="next"><a href="/TIL/ML/cs224n_4.html">
        cs224n Lecture 13
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/TIL/assets/js/app.2722f0f6.js" defer></script><script src="/TIL/assets/js/2.2c4c9c51.js" defer></script><script src="/TIL/assets/js/17.07c38e4d.js" defer></script>
  </body>
</html>
