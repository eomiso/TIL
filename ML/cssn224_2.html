<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CS224n 6강 | Eomiso&#39;s TIL(Today I Learned)</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/TIL/logo.png">
    <meta name="description" content="Write what you have learned today">
    <link rel="preload" href="/TIL/assets/css/0.styles.34c10105.css" as="style"><link rel="preload" href="/TIL/assets/js/app.2722f0f6.js" as="script"><link rel="preload" href="/TIL/assets/js/2.2c4c9c51.js" as="script"><link rel="preload" href="/TIL/assets/js/23.8b174a85.js" as="script"><link rel="prefetch" href="/TIL/assets/js/10.2f8e0e30.js"><link rel="prefetch" href="/TIL/assets/js/11.1ff1a57e.js"><link rel="prefetch" href="/TIL/assets/js/12.15c40c13.js"><link rel="prefetch" href="/TIL/assets/js/13.7bf652e1.js"><link rel="prefetch" href="/TIL/assets/js/14.c9414a20.js"><link rel="prefetch" href="/TIL/assets/js/15.2d01f370.js"><link rel="prefetch" href="/TIL/assets/js/16.0d89dffe.js"><link rel="prefetch" href="/TIL/assets/js/17.07c38e4d.js"><link rel="prefetch" href="/TIL/assets/js/18.442c0c06.js"><link rel="prefetch" href="/TIL/assets/js/19.1b5bf633.js"><link rel="prefetch" href="/TIL/assets/js/20.86bba05d.js"><link rel="prefetch" href="/TIL/assets/js/21.e544340d.js"><link rel="prefetch" href="/TIL/assets/js/22.65a2edf5.js"><link rel="prefetch" href="/TIL/assets/js/24.64fc03d5.js"><link rel="prefetch" href="/TIL/assets/js/25.ce0ae723.js"><link rel="prefetch" href="/TIL/assets/js/26.8b8ee881.js"><link rel="prefetch" href="/TIL/assets/js/27.bf8c97e7.js"><link rel="prefetch" href="/TIL/assets/js/28.142e3c12.js"><link rel="prefetch" href="/TIL/assets/js/29.81bd0da5.js"><link rel="prefetch" href="/TIL/assets/js/3.313ef446.js"><link rel="prefetch" href="/TIL/assets/js/30.359dbc7f.js"><link rel="prefetch" href="/TIL/assets/js/31.0727ec46.js"><link rel="prefetch" href="/TIL/assets/js/32.fe1c9148.js"><link rel="prefetch" href="/TIL/assets/js/33.a56a58e6.js"><link rel="prefetch" href="/TIL/assets/js/34.27b6efed.js"><link rel="prefetch" href="/TIL/assets/js/35.62f50cfb.js"><link rel="prefetch" href="/TIL/assets/js/36.87dcc99f.js"><link rel="prefetch" href="/TIL/assets/js/37.0e07a91e.js"><link rel="prefetch" href="/TIL/assets/js/38.205eff79.js"><link rel="prefetch" href="/TIL/assets/js/39.aaa60523.js"><link rel="prefetch" href="/TIL/assets/js/4.b761c68e.js"><link rel="prefetch" href="/TIL/assets/js/40.6b01a59c.js"><link rel="prefetch" href="/TIL/assets/js/41.1eb27f61.js"><link rel="prefetch" href="/TIL/assets/js/42.6841e3f3.js"><link rel="prefetch" href="/TIL/assets/js/43.de455827.js"><link rel="prefetch" href="/TIL/assets/js/5.a3718665.js"><link rel="prefetch" href="/TIL/assets/js/6.13ab33a4.js"><link rel="prefetch" href="/TIL/assets/js/7.d95456ce.js"><link rel="prefetch" href="/TIL/assets/js/8.8630e26e.js"><link rel="prefetch" href="/TIL/assets/js/9.1c63a592.js">
    <link rel="stylesheet" href="/TIL/assets/css/0.styles.34c10105.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TIL/" class="home-link router-link-active"><!----> <span class="site-name">Eomiso's TIL(Today I Learned)</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/eomiso" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://eomiso.blogspot.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/eomiso" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://eomiso.blogspot.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>1. Python</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2. Git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>3. Java</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>4. C++</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>5. Machine Learning</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TIL/ML/cssn224_1.html" class="sidebar-link">CSS224n Lecture 12</a></li><li><a href="/TIL/ML/cssn224_2.html" class="active sidebar-link">CS224n 6강</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TIL/ML/cssn224_2.html#개요" class="sidebar-link">개요</a></li><li class="sidebar-sub-header"><a href="/TIL/ML/cssn224_2.html#language-modeling" class="sidebar-link">Language Modeling</a></li><li class="sidebar-sub-header"><a href="/TIL/ML/cssn224_2.html#n-gram-sparsity-problem" class="sidebar-link">N-gram, sparsity problem</a></li><li class="sidebar-sub-header"><a href="/TIL/ML/cssn224_2.html#generating-texts-with-fixed-window" class="sidebar-link">Generating Texts with Fixed Window</a></li><li class="sidebar-sub-header"><a href="/TIL/ML/cssn224_2.html#rnn" class="sidebar-link">RNN</a></li><li class="sidebar-sub-header"><a href="/TIL/ML/cssn224_2.html#back-propagation-through-time" class="sidebar-link">Back Propagation through time</a></li><li class="sidebar-sub-header"><a href="/TIL/ML/cssn224_2.html#generating-text-with-rnn" class="sidebar-link">Generating Text with RNN</a></li><li class="sidebar-sub-header"><a href="/TIL/ML/cssn224_2.html#perplexity" class="sidebar-link">Perplexity</a></li></ul></li><li><a href="/TIL/ML/cs224n_3.html" class="sidebar-link">cs224n Lecture 8</a></li><li><a href="/TIL/ML/cs224n_4.html" class="sidebar-link">cs224n Lecture 13</a></li><li><a href="/TIL/ML/cs224n_5.html" class="sidebar-link">cs224n Lecture 14</a></li><li><a href="/TIL/ML/cs224n_6.html" class="sidebar-link">cs224n 10강 정리</a></li><li><a href="/TIL/ML/cs224n_7.html" class="sidebar-link">cs224n lecture 15</a></li><li><a href="/TIL/ML/ml_dict.html" class="sidebar-link">Machine Learning 용어 사전</a></li><li><a href="/TIL/ML/style_transfer.html" class="sidebar-link">Style Transfer from Non-Parallel Text by Cross-Alignment 리뷰</a></li><li><a href="/TIL/ML/using_bert.html" class="sidebar-link">Bert 사용기</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>6. Computer Structure</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Mics.</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="cs224n-6강"><a href="#cs224n-6강" class="header-anchor">#</a> CS224n 6강</h1> <h2 id="개요"><a href="#개요" class="header-anchor">#</a> 개요</h2> <ol><li>Language modeling</li> <li>N-gram, sparsity problem</li> <li>Generating text with fixed window</li> <li>RNN</li> <li>Back propgation through time</li> <li>Generating text with RNN</li> <li>Perplexity</li></ol> <h2 id="language-modeling"><a href="#language-modeling" class="header-anchor">#</a> Language Modeling</h2> <div class="custom-block tip"><p class="custom-block-title">Definition</p> <p><strong>Langauge Modeling</strong> is the task of predicting &quot;ANSWER&quot;.</p></div> <details class="custom-block details"><summary>ANSWER</summary> <p>what word comes next.</p></details> <p>보다 정확히는 sequence of words 가 주어졌을 때, 다음 단어의 probability distribution 을 계산하는 것
</p><p><mjx-container jax="CHTML" display="true" class="MathJax"><mjx-math display="true" class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.413em;"><mjx-TeXAtom size="s"><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="+"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-TeXAtom></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.413em;"><mjx-TeXAtom size="s"><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-TeXAtom></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mo space="2" class="mjx-n"><mjx-c c="22EF"></mjx-c></mjx-mo><mjx-mo space="2" class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msup space="2"><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.413em;"><mjx-TeXAtom size="s"><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-TeXAtom></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container></p>
여기서 <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msup><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;"><mjx-TeXAtom size="s"><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="+"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-TeXAtom></mjx-script></mjx-msup></mjx-math></mjx-container> 는 vocabulary 상의 그 어떤 단어든지 될 수 있는데, 주어진 선택지에서 한가지를 고른다는 점에서 classification 문제로 볼 수 있다.<br>
또는 어떤 텍스트에 확률을 지정하는 시스템(A system that assigns probablity to a piece of text)으로 볼 수도 있다.<p></p> <blockquote><p>핸드폰에서 자동단어 완성해주는 것도 LM의 일종이다.</p></blockquote> <h2 id="n-gram-sparsity-problem"><a href="#n-gram-sparsity-problem" class="header-anchor">#</a> N-gram, sparsity problem</h2> <p>그래서 이런 LM을 학습하기 위해서는 어떻게 해야하는가?</p> <div class="custom-block warning"><p class="custom-block-title">Quote</p> <p>How to learn a Language Model?</p></div> <p>Deep Learning의 시대가 오기 전에는 <strong>n-gram LM</strong> 을사용하였다. (자세한 사항은 슬라이드 참고)</p> <p>n-gram 에서는 우선, markov assumption(어떤 단어는 그 앞의 n-1개의 단어에만 의존한다
</p><p><mjx-container jax="CHTML" display="true" class="MathJax"><mjx-math display="true" class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="w"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mtext class="mjx-n"><mjx-c c="s"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="u"></mjx-c><mjx-c c="d"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="n"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="s"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="p"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="n"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="d"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="h"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="i"></mjx-c><mjx-c c="r"></mjx-c></mjx-mtext><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mstyle space="4"><mjx-mfrac><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mtext class="mjx-n"><mjx-c c="c"></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="u"></mjx-c><mjx-c c="n"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="("></mjx-c><mjx-c c="s"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="u"></mjx-c><mjx-c c="d"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="n"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="s"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="p"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="n"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="d"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="h"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="i"></mjx-c><mjx-c c="r"></mjx-c><mjx-c c="A0"></mjx-c></mjx-mtext><mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c c="w"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-mtext class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mtext></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mtext class="mjx-n"><mjx-c c="c"></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="u"></mjx-c><mjx-c c="n"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="("></mjx-c><mjx-c c="s"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="u"></mjx-c><mjx-c c="d"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="n"></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="s"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="p"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="n"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="d"></mjx-c><mjx-c c=" "></mjx-c><mjx-c c="t"></mjx-c><mjx-c c="h"></mjx-c><mjx-c c="e"></mjx-c><mjx-c c="i"></mjx-c><mjx-c c="r"></mjx-c><mjx-c c=")"></mjx-c></mjx-mtext></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle></mjx-math></mjx-container></p><p></p> <p>하지만 sparcity, storage problem 이 있다.
Sparcity problem 이란 분자가 0이 되는 경우, 즉 token 이 training 데이터에서 드러나지 않는 경우가 많아 발생한다. 충분히 생성가능한 문장임에도 확률이 낮다는 이유로 절대 나타나지 않을 수 있다는 말이다.
이를 해결하기 위해 작은 델타 값을 더해주기도 하고, 만약 분모가 0이라면 window size를 줄여서 분모가 0 보다 커지도록 한다.</p> <p>LM은 문장을 생성하는데 사용되기도 하는데, n-gram으로는 굉장히 grammatical 한 문장을 생성할 수 있지만 이는 매우 incoherent 하다는 것을 확인할 수 있다.</p> <blockquote><p>Today the price of gold per ton, while production of shoe lasts and shoe insdustry, the bank intervened just after it considered rejected an imf demand to rebuild ...</p></blockquote> <h2 id="generating-texts-with-fixed-window"><a href="#generating-texts-with-fixed-window" class="header-anchor">#</a> Generating Texts with Fixed Window</h2> <p><img src="/TIL/ML/window_LM.png" alt="A slide from cs224n">
No sparsity problem, Don't need to store all observed n-grams 라는 문제가 있다.</p> <p>단점: Fixed window is too small; Enlarging window enlarges W; window can never be large enough; W 의 각각의 벡터가 서로 연관되지 못한다(there should be lot of commonalities in how you process the incoming word embeddings).;     -&gt; 일단 기본적으로 window의 크기에 제한을 받는다는 문제가 있다.</p> <h2 id="rnn"><a href="#rnn" class="header-anchor">#</a> RNN</h2> <p>window의 크기에 제한 받지 않는 모델, sequence의 길이가 얼마나 길든 문제가 되지 않는다.</p> <p><img src="/TIL/ML/Rnn.png" alt="A slide2 from cs224n"></p> <p><img src="/TIL/ML/Rnn2.png" alt=""></p> <p>장점: step t 에서의 연산은 여러 스텝 이전의 정보를 사용할 수 있다(in theory;  앞의 예시에서 proctor가 중요한 정보를 담고 있다는 점을 반영할 수 있다는 얘기);  W의 크기가 일정하다(2개의 W가 있긴하지만); 동일한 W가 각각의 input에 동일하게 적용되기 때문에 (W 의 각각의 벡터가 서로 연관되지 못하는) window base 모델에서의 단점을 극복할 수 있다. 따라서 한 input에 대해서 잘 효과적인 학습이 되면 그 이점을 모든 input에 대해 누릴 수 있다는 장점이 있다;</p> <p>단점: 연산이 느리다;  실전에서는 여러 스텝 이전의 정보에 접근이 어렵다;</p> <p>::: Danger
Why is the same transfromation (W_h, W_e) applied each time? While a sequence of words could always appear in Different contexts?
<s>와씨 개좋은 질문이다</s>
&quot;You are learning a general function, not just with one word in blank. A general function of how you should deal with a word given the word so far. In other word RNN is a method to learn a general representation of language and context so far.
And the hidden states are <strong>vector</strong> of lenghts almost 500 or more. So their capacities are big enough to hold a lot of informations about different things in their different postions.&quot; ~~ 스탠 학생들 똑똑하다~~
:::</p> <p>input size는 데이터에 따라서, 어떤 효과를 원하냐에 따라서 짧게 할 수도, 길게 할 수도 있다. 그리고 그 길이는 W_h에 영향을 미치지 않는다.</p> <p>Rnn의 로스는 각각 hidden state의 결과인 <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mtext class="mjx-n" style="color:red;"><mjx-c c="5C"></mjx-c><mjx-c c="^"></mjx-c></mjx-mtext><mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-math></mjx-container> 를 통해 로스 값을 구한 다음 그 평균을 구한다. 그런데 이를 전체 코퍼스에 적용하기는 연산량이 너무 많기 때문에 <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msup><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;"><mjx-TeXAtom size="s"><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-TeXAtom></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msup space="2"><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;"><mjx-TeXAtom size="s"><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="2"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-TeXAtom></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msup space="2"><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;"><mjx-TeXAtom size="s"><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="3"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-TeXAtom></mjx-script></mjx-msup><mjx-mo space="2" class="mjx-n"><mjx-c c="2026"></mjx-c></mjx-mo><mjx-msup space="2"><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;"><mjx-TeXAtom size="s"><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-TeXAtom></mjx-script></mjx-msup></mjx-math></mjx-container> 를 sentence 나 document 단위로 한다.</p> <p>또한 batch Gradient Descent를 적용한다.</p> <h2 id="back-propagation-through-time"><a href="#back-propagation-through-time" class="header-anchor">#</a> Back Propagation through time</h2> <p><s>이 슬라이드 하나면 충분해요</s></p> <p><img src="/TIL/ML/Rnn_backprop.png" alt="Backpropagation Slide"></p> <h2 id="generating-text-with-rnn"><a href="#generating-text-with-rnn" class="header-anchor">#</a> Generating Text with RNN</h2> <p>Repeated sampling 이라는 것을 이용해서 텍스트를 산출할 수 있다.
요것이 재밌는 것이, RNN-LM 을 어떤 데이터로 학습시켰냐에 따라서 그 데이터의 스타일 대로 산출할 수 있다는 것이다(오바마 연설체, 문체 등을 배낄 수 있다는 얘기)
그러나 예시를 보면 아직은 꽤 incoherent 하다는 것을 알 수 있다.
<img src="/TIL/ML/Rnn_generate.png" alt="Generation via repeated sampling"></p> <h2 id="perplexity"><a href="#perplexity" class="header-anchor">#</a> Perplexity</h2> <p></p><p><mjx-container jax="CHTML" display="true" class="MathJax"><mjx-math display="true" class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="J"></mjx-c></mjx-mi><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mstyle space="4"><mjx-mfrac><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mi class="mjx-i"><mjx-c c="T"></mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-munderover space="2"><mjx-over style="padding-bottom:0.2em;padding-left:0.473em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="T"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-lop"><mjx-c c="2211"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top:0.167em;padding-left:0.143em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-munderover space="2"><mjx-over style="padding-bottom:0.111em;padding-left:0.254em;"><mjx-TeXAtom size="s"><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="V"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo></mjx-TeXAtom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-lop"><mjx-c c="2211"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top:0.167em;padding-left:0.124em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-msub space="2"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo space="3" class="mjx-n"><mjx-c c="2217"></mjx-c></mjx-mo><mjx-mi space="3" class="mjx-i"><mjx-c c="l"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="o"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="g"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mtext class="mjx-n" style="color:red;"><mjx-c c="5C"></mjx-c><mjx-c c="^"></mjx-c></mjx-mtext><mjx-msub><mjx-TeXAtom><mjx-mi noIC="true" class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi></mjx-TeXAtom><mjx-script style="vertical-align:-0.24em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container></p> <p><mjx-container jax="CHTML" display="true" class="MathJax"><mjx-math display="true" class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="P"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="r"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="p"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="l"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="y"></mjx-c></mjx-mi><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-msup><mjx-mn class="mjx-n"><mjx-c c="2"></mjx-c></mjx-mn><mjx-script style="vertical-align:0.413em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="J"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container></p>
Perplexity is the standard evaluation metric for Language Models.
Perplexity is a measure of confusion where lower values imply more confidence in predicting the next word in the sequence (compared to the ground truth outcome).<p></p> <p><img src="/TIL/ML/Rnn_perplexity.png" alt="Perplexity"></p> <hr> <p>왜 LM이 중요한가?</p> <ul><li>Language Modeling은 실제 언어를 이해하는데 대한 benchmark task다. LM이 보다 좋은 성능을 낸다는 것은 어느 부분에서 Natural Language Understanding에 progress가 있었다는 것을 의미한다.</li> <li>또한 LM은 다양한 NLP task의 subcomponent로 기능한다.</li></ul> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>RNN is not Language Model
It could be used for variety of tasks such as pos tagging, NER, sentence classification, general purpose encoder module.</p></div> <p>::: detail
Question Answering을 할 때, question에 대한 encoder로 RNN을 사용할 수 있다.
Speech Recognition을 할 때는, conditioning 을 거쳐 output을 생성한다.
:::</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/12/2020, 1:46:49 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/TIL/ML/cssn224_1.html" class="prev">
        CSS224n Lecture 12
      </a></span> <span class="next"><a href="/TIL/ML/cs224n_3.html">
        cs224n Lecture 8
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/TIL/assets/js/app.2722f0f6.js" defer></script><script src="/TIL/assets/js/2.2c4c9c51.js" defer></script><script src="/TIL/assets/js/23.8b174a85.js" defer></script>
  </body>
</html>
