(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{371:function(t,n,s){"use strict";s.r(n);var a=s(20),e=Object(a.a)({},(function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"bert-사용기"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bert-사용기"}},[t._v("#")]),t._v(" Bert 사용기")]),t._v(" "),s("h2",{attrs:{id:"getting-word-embedding-from-bert-tokenizer"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#getting-word-embedding-from-bert-tokenizer"}},[t._v("#")]),t._v(" getting word_embedding from bert tokenizer")]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_bert_word_embedding")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" transformers "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" BertModel\n    BERT "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" BertModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("from_pretrained"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bert-base-uncased'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n    num_embeddings "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" bert_tokenizer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("vocab_size "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bert_tokenizer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get_added_vocab"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    embed_dim "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" BERT"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("embeddings"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("word_embeddings"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("embedding_dim\n    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# need to add embedding for bos and eos token")]),t._v("\n    embedding "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Embedding"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("num_embeddings"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" embed_dim"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" padding_idx"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("bert_tokenizer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pad_token_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    embedding"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("weight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("bert_tokenizer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("vocab_size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" BERT"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("embeddings"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("word_embeddings"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("weight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" embedding\n")])])])])}),[],!1,null,null,null);n.default=e.exports}}]);